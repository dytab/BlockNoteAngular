const d=function(e,t,n,r,i){const a=w(t);return P(e)?a.call(i,e,n,r):!1},w=function(e){if(e==null)return C;if(typeof e=="string")return M(e);if(typeof e=="object")return q(e);if(typeof e=="function")return A(e);throw new Error("Expected function, string, or array as `test`")};function q(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=w(e[n]);return A(r);function r(...i){let a=-1;for(;++a<t.length;)if(t[a].apply(this,i))return!0;return!1}}function M(e){return A(t);function t(n){return n.tagName===e}}function A(e){return t;function t(n,r,i){return!!(P(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function C(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="element"&&"tagName"in e&&typeof e.tagName=="string")}function P(e){return e!==null&&typeof e=="object"&&"type"in e&&"tagName"in e}const v=w(function(e){return e.tagName==="audio"||e.tagName==="canvas"||e.tagName==="embed"||e.tagName==="iframe"||e.tagName==="img"||e.tagName==="math"||e.tagName==="object"||e.tagName==="picture"||e.tagName==="svg"||e.tagName==="video"}),K={}.hasOwnProperty;function U(e,t){const n=e.type==="element"&&K.call(e.properties,t)&&e.properties[t];return n!=null&&n!==!1}const X=new Set(["pingback","prefetch","stylesheet"]);function z(e){if(e.type!=="element"||e.tagName!=="link")return!1;if(e.properties.itemProp)return!0;const t=e.properties.rel;let n=-1;if(!Array.isArray(t)||t.length===0)return!1;for(;++n<t.length;)if(!X.has(String(t[n])))return!1;return!0}const D=w(["a","abbr","area","b","bdi","bdo","br","button","cite","code","data","datalist","del","dfn","em","i","input","ins","kbd","keygen","label","map","mark","meter","noscript","output","progress","q","ruby","s","samp","script","select","small","span","strong","sub","sup","template","textarea","time","u","var","wbr"]),G=w("meta");function H(e){return!!(e.type==="text"||D(e)||v(e)||z(e)||G(e)&&U(e,"itemProp"))}const J=/[ \t\n\f\r]/g;function k(e){return typeof e=="object"?e.type==="text"?B(e.value):!1:B(e)}function B(e){return e.replace(J,"")===""}const Q=["pre","script","style","textarea"],S=function(e){if(e==null)return _;if(typeof e=="function")return N(e);if(typeof e=="object")return Array.isArray(e)?V(e):Y(e);if(typeof e=="string")return Z(e);throw new Error("Expected function, string, or object as test")};function V(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=S(e[n]);return N(r);function r(...i){let a=-1;for(;++a<t.length;)if(t[a].apply(this,i))return!0;return!1}}function Y(e){const t=e;return N(n);function n(r){const i=r;let a;for(a in e)if(i[a]!==t[a])return!1;return!0}}function Z(e){return N(t);function t(n){return n&&n.type===e}}function N(e){return t;function t(n,r,i){return!!(ee(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function _(){return!0}function ee(e){return e!==null&&typeof e=="object"&&"type"in e}const te=["address","article","aside","blockquote","body","br","caption","center","col","colgroup","dd","dialog","dir","div","dl","dt","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","legend","li","li","listing","main","menu","nav","ol","optgroup","option","p","plaintext","pre","section","summary","table","tbody","td","td","tfoot","th","th","thead","tr","ul","wbr","xmp"],ne=["button","input","select","textarea"],re=["area","base","basefont","dialog","datalist","head","link","meta","noembed","noframes","param","rp","script","source","style","template","track","title"],ie={},j=S(["doctype","comment"]);function ae(e){const n=pe((e||ie).newlines?fe:se);return function(r){$(r,{collapse:n,whitespace:"normal"})}}function $(e,t){if("children"in e){const n={...t};return(e.type==="root"||W(e))&&(n.before=!0,n.after=!0),n.whitespace=he(e,t),oe(e,n)}if(e.type==="text"){if(t.whitespace==="normal")return ce(e,t);t.whitespace==="nowrap"&&(e.value=t.collapse(e.value))}return{ignore:j(e),stripAtStart:!1,remove:!1}}function ce(e,t){const n=t.collapse(e.value),r={ignore:!1,stripAtStart:!1,remove:!1};let i=0,a=n.length;return t.before&&E(n.charAt(0))&&i++,i!==a&&E(n.charAt(a-1))&&(t.after?a--:r.stripAtStart=!0),i===a?r.remove=!0:e.value=n.slice(i,a),r}function oe(e,t){let n=t.before;const r=t.after,i=e.children;let a=i.length,c=-1;for(;++c<a;){const l=$(i[c],{...t,after:O(i,c,r),before:n});l.remove?(i.splice(c,1),c--,a--):l.ignore||(n=l.stripAtStart),I(i[c])&&(n=!1)}return{ignore:!1,stripAtStart:!!(n||r),remove:!1}}function O(e,t,n){for(;++t<e.length;){const r=e[t];let i=le(r);if(i===void 0&&"children"in r&&!ue(r)&&(i=O(r.children,-1)),typeof i=="boolean")return i}return n}function le(e){if(e.type==="element"){if(I(e))return!1;if(W(e))return!0}else if(e.type==="text"){if(!k(e))return!1}else if(!j(e))return!1}function I(e){return v(e)||d(e,ne)}function W(e){return d(e,te)}function ue(e){return!!(e.type==="element"&&e.properties.hidden)||j(e)||d(e,re)}function E(e){return e===" "||e===`
`}function fe(e){const t=/\r?\n|\r/.exec(e);return t?t[0]:" "}function se(){return" "}function pe(e){return t;function t(n){return String(n).replace(/[\t\n\v\f\r ]+/g,e)}}function he(e,t){if("tagName"in e&&e.properties)switch(e.tagName){case"listing":case"plaintext":case"script":case"style":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return e.properties.wrap?"pre-wrap":"pre";case"td":case"th":return e.properties.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}return t.whitespace}const T=[],ye=!0,F=!1,L="skip";function ge(e,t,n,r){let i;typeof t=="function"&&typeof n!="function"?(r=n,n=t):i=t;const a=S(i),c=r?-1:1;l(e,void 0,[])();function l(o,g,f){const u=o&&typeof o=="object"?o:{};if(typeof u.type=="string"){const s=typeof u.tagName=="string"?u.tagName:typeof u.name=="string"?u.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(o.type+(s?"<"+s+">":""))+")"})}return m;function m(){let s=T,p,h,y;if((!t||a(o,g,f[f.length-1]||void 0))&&(s=me(n(o,f)),s[0]===F))return s;if("children"in o&&o.children){const b=o;if(b.children&&s[0]!==L)for(h=(r?b.children.length:-1)+c,y=f.concat(b);h>-1&&h<b.children.length;){const R=b.children[h];if(p=l(R,h,y)(),p[0]===F)return p;h=typeof p[1]=="number"?p[1]:h+c}}return s}}}function me(e){return Array.isArray(e)?e:typeof e=="number"?[ye,e]:e==null?T:[e]}const de={},be=ae({newlines:!0});function we(e){const t=e||de;let n=t.indent||2,r=t.indentInitial;return typeof n=="number"&&(n=" ".repeat(n)),r==null&&(r=!0),function(c){let l;be(c),ge(c,function(o,g){let f=-1;if(!("children"in o))return;if(d(o,"head")&&(l=!0),l&&d(o,"body")&&(l=void 0),d(o,Q))return L;const u=o.children;let m=g.length;if(u.length===0||!x(o,l))return;r||m--;let s;for(;++f<u.length;){const y=u[f];(y.type==="text"||y.type==="comment")&&(y.value.includes(`
`)&&(s=!0),y.value=y.value.replace(/ *\n/g,"$&"+String(n).repeat(m)))}const p=[];let h;for(f=-1;++f<u.length;){const y=u[f];(x(y,l)||s&&!f)&&(i(p,m,y),s=!0),h=y,p.push(y)}h&&(s||x(h,l))&&(k(h)&&(p.pop(),h=p[p.length-1]),i(p,m-1)),o.children=p})};function i(c,l,o){const g=c[c.length-1],f=g&&k(g)?c[c.length-2]:g,u=(a(f)&&a(o)?`

`:`
`)+String(n).repeat(Math.max(l,0));g&&g.type==="text"?g.value=k(g)?u:g.value+u:c.push({type:"text",value:u})}function a(c){return!!(c&&c.type==="element"&&t.blanks&&t.blanks.length>0&&t.blanks.includes(c.tagName))}}function x(e,t){return e.type==="root"||(e.type==="element"?t||d(e,"script")||v(e)||!H(e):!1)}export{we as default};
